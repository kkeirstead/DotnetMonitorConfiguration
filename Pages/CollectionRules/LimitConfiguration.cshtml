@page
@using DotnetMonitorConfiguration.Models
@using System.ComponentModel.DataAnnotations
@model LimitConfigurationModel

<form method="post">
  <div class="row-narrow">
    <fieldset>
        @{
            int index = 0;
        }
        @foreach(var propertyInfo in LimitConfigurationModel.GetConfigurationSettings())
        {
            Type currType = @propertyInfo.PropertyType;
            Type? underlyingType = Nullable.GetUnderlyingType(currType);
            currType = (underlyingType != null) ? underlyingType : currType;

            bool isDefined = Attribute.IsDefined(propertyInfo, typeof(RequiredAttribute));

            if (isDefined)
            {
                <div class="label">@propertyInfo.Name *</div>                    
            }
            else
            {
                <div class="label">@propertyInfo.Name</div>                    
            }
            
            <div class="sub-label">@General.GetFormatDescription(currType)</div>

            string val = @LimitConfigurationModel.GetCurrValue(propertyInfo);

            if (currType.IsEnum)
            {
                <select asp-for=properties[index.ToString()]>
                    @foreach (var enumName in Enum.GetNames(currType))
                    {
                        if (val.Equals(enumName))
                        {
                            <option value=@enumName selected>@enumName</option>
                        }
                        else
                        {
                            <option value=@enumName>@enumName</option>                                
                        }
                    }
                </select>
            }
            else
            {
                <input asp-for=properties[index.ToString()] placeholder=@propertyInfo.Name value=@val/>
            }
            <br />
            ++index;
        }
        
   </fieldset>
  </div>

  <button class="submit-button" type="submit" asp-route-data="Submit" asp-page-handler="Way2" id="submitButton">Submit</button>

</form>